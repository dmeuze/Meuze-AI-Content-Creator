<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if language == 'en' %}Meuze AI - Content Creator{% else %}Meuze AI - Content Creator{% endif %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="container">
        <h1 class="text-center">{% if language == 'en' %}Meuze AI - Content Creator{% else %}Meuze AI - Content Creator{% endif %}</h1>
        
        <form method="POST" class="mb-4" id="contentForm">
            <div class="mb-3">
                <label for="language" class="form-label">{% if language == 'en' %}Select Language:{% else %}Selecteer Taal:{% endif %}</label>
                <select class="form-select" id="language" name="language">
                    <option value="en" {% if language == 'en' %}selected{% endif %}>English</option>
                    <option value="nl" {% if language == 'nl' %}selected{% endif %}>Dutch</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="user_prompt" class="form-label">{% if language == 'en' %}Enter your prompt:{% else %}Voer je prompt in:{% endif %}</label>
                <textarea class="form-control" id="user_prompt" name="user_prompt" rows="3" required 
                    placeholder="{% if language == 'en' %}Start typing...{% else %}Begin met typen...{% endif %}"></textarea>
            </div>
            <button type="submit" class="btn btn-primary" id="generateButton">
                {% if language == 'en' %}Generate Content{% else %}Content Genereren{% endif %}
            </button>
        </form>

        {% if user_prompt %}
        <div class="user-prompt">
            <h5>{% if language == 'en' %}Your Prompt:{% else %}Jouw Prompt:{% endif %}</h5>
            <p>{{ user_prompt }}</p>
        </div>
        {% endif %}

        <div id="contentContainer" class="content-box d-none">
            <div id="loadingContent" class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2 mb-0">{% if language == 'en' %}Generating content...{% else %}Content genereren...{% endif %}</p>
            </div>
            <div id="generatedContent" class="d-none">
                <h4 class="mb-2">{% if language == 'en' %}Generated Content:{% else %}Gegenereerde Content:{% endif %}</h4>
                <p class="mb-0">{{ response_text }}</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function resetContentContainer() {
            const contentContainer = document.getElementById('contentContainer');
            const loadingContent = document.getElementById('loadingContent');
            const generatedContent = document.getElementById('generatedContent');
            
            contentContainer.classList.remove('d-none');
            loadingContent.classList.remove('d-none');
            generatedContent.classList.add('d-none');
        }

        document.getElementById('contentForm').addEventListener('submit', function(e) {
            const button = document.getElementById('generateButton');
            
            // Only show loading if the submit was triggered by the Generate Content button
            if (e.submitter && e.submitter.id === 'generateButton') {
                // Disable the button
                button.disabled = true;
                
                // Reset and show the content container with loading state
                resetContentContainer();
                
                // Re-enable the button after 5 seconds (fallback in case of error)
                setTimeout(() => {
                    button.disabled = false;
                }, 5000);
            }
        });

        // Add event listener for language change
        document.getElementById('language').addEventListener('change', function() {
            // Only hide the content container when language changes
            document.getElementById('contentContainer').classList.add('d-none');
            // Update the form action to include the new language
            const form = document.getElementById('contentForm');
            form.action = window.location.pathname + '?language=' + this.value;
            form.submit();
        });

        // Show generated content if it exists
        {% if response_text %}
        document.addEventListener('DOMContentLoaded', function() {
            const contentContainer = document.getElementById('contentContainer');
            const loadingContent = document.getElementById('loadingContent');
            const generatedContent = document.getElementById('generatedContent');
            
            contentContainer.classList.remove('d-none');
            loadingContent.classList.add('d-none');
            generatedContent.classList.remove('d-none');
        });
        {% endif %}
    </script>
</body>
</html>
